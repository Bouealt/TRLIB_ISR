<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <!-- 背景 -->
  <rect width="800" height="600" fill="#f8f9fa" />
  
  <!-- 标题 -->
  <text x="400" y="30" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold">TRLIB 事件处理流程</text>
  
  <!-- 参与者框 -->
  <rect x="50" y="50" width="120" height="50" rx="5" fill="#e6e6ff" stroke="#9999cc" />
  <text x="110" y="80" font-family="Arial" font-size="14" text-anchor="middle">IOEvent</text>
  
  <rect x="220" y="50" width="120" height="50" rx="5" fill="#e6e6ff" stroke="#9999cc" />
  <text x="280" y="80" font-family="Arial" font-size="14" text-anchor="middle">EventScheduler</text>
  
  <rect x="390" y="50" width="120" height="50" rx="5" fill="#e6e6ff" stroke="#9999cc" />
  <text x="450" y="80" font-family="Arial" font-size="14" text-anchor="middle">EpollPoller</text>
  
  <rect x="560" y="50" width="120" height="50" rx="5" fill="#e6e6ff" stroke="#9999cc" />
  <text x="620" y="80" font-family="Arial" font-size="14" text-anchor="middle">ISRConnection</text>
  
  <!-- 生命线 -->
  <line x1="110" y1="100" x2="110" y2="550" stroke="#9999cc" stroke-dasharray="5,5" />
  <line x1="280" y1="100" x2="280" y2="550" stroke="#9999cc" stroke-dasharray="5,5" />
  <line x1="450" y1="100" x2="450" y2="550" stroke="#9999cc" stroke-dasharray="5,5" />
  <line x1="620" y1="100" x2="620" y2="550" stroke="#9999cc" stroke-dasharray="5,5" />
  
  <!-- 事件循环框 -->
  <rect x="100" y="120" width="600" height="410" rx="10" fill="none" stroke="#aaaaaa" stroke-dasharray="5,5" />
  <text x="140" y="145" font-family="Arial" font-size="14">loop</text>
  <text x="180" y="145" font-family="Arial" font-size="14" fill="#666666">[事件循环]</text>
  
  <!-- 消息1：处理触发事件 -->
  <line x1="280" y1="170" x2="350" y2="170" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="350" y1="170" x2="280" y2="170" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <text x="315" y="160" font-family="Arial" font-size="12" text-anchor="middle">handleTriggerEvent()</text>
  
  <!-- 注释框1 -->
  <rect x="330" y="180" width="200" height="30" rx="5" fill="#ffffcc" stroke="#ddddaa" />
  <text x="430" y="200" font-family="Arial" font-size="12" text-anchor="middle">处理触发事件(发送消息等)</text>
  
  <!-- 消息2：调用Poller处理IO事件 -->
  <line x1="280" y1="230" x2="450" y2="230" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <text x="365" y="220" font-family="Arial" font-size="12" text-anchor="middle">handleEvent()</text>
  
  <!-- 消息3：epoll_wait -->
  <line x1="450" y1="260" x2="520" y2="260" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="520" y1="260" x2="450" y2="260" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <text x="485" y="250" font-family="Arial" font-size="12" text-anchor="middle">epoll_wait</text>
  
  <!-- 注释框2 -->
  <rect x="530" y="245" width="200" height="30" rx="5" fill="#ffffcc" stroke="#ddddaa" />
  <text x="630" y="265" font-family="Arial" font-size="12" text-anchor="middle">等待IO事件(连接/数据)</text>
  
  <!-- 事件发生框 -->
  <rect x="200" y="290" width="500" height="160" rx="10" fill="none" stroke="#aaaaaa" stroke-dasharray="5,5" />
  <text x="230" y="310" font-family="Arial" font-size="14">alt</text>
  <text x="270" y="310" font-family="Arial" font-size="14" fill="#666666">[有IO事件]</text>
  
  <!-- 消息4：设置事件类型 -->
  <line x1="450" y1="330" x2="520" y2="330" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="520" y1="330" x2="450" y2="330" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <text x="485" y="320" font-family="Arial" font-size="12" text-anchor="middle">设置事件类型</text>
  
  <!-- 消息5：设置事件 -->
  <line x1="450" y1="360" x2="110" y2="360" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <text x="280" y="350" font-family="Arial" font-size="12" text-anchor="middle">setEvent(EVENT_READ/WRITE)</text>
  
  <!-- 消息6：处理事件 -->
  <line x1="450" y1="390" x2="110" y2="390" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <text x="280" y="380" font-family="Arial" font-size="12" text-anchor="middle">handleEvent()</text>
  
  <!-- 消息7：回调函数 -->
  <line x1="110" y1="420" x2="620" y2="420" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <text x="365" y="410" font-family="Arial" font-size="12" text-anchor="middle">readCallback/writeCallback</text>
  
  <!-- 定时器事件框 -->
  <rect x="200" y="470" width="500" height="80" rx="10" fill="none" stroke="#aaaaaa" stroke-dasharray="5,5" />
  <text x="230" y="490" font-family="Arial" font-size="14">alt</text>
  <text x="270" y="490" font-family="Arial" font-size="14" fill="#666666">[定时器事件]</text>
  
  <!-- 消息8：检查定时器 -->
  <line x1="280" y1="520" x2="350" y2="520" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <text x="315" y="510" font-family="Arial" font-size="12" text-anchor="middle">检查定时器事件</text>
  
  <!-- 处理函数框 -->
  <rect x="650" y="430" width="120" height="60" rx="5" fill="#e6f7ff" stroke="#91d5ff" />
  <text x="710" y="455" font-family="Arial" font-size="12" text-anchor="middle">handleRead()</text>
  <text x="710" y="475" font-family="Arial" font-size="12" text-anchor="middle">处理协议消息</text>
  
  <!-- 箭头定义 -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333" />
    </marker>
  </defs>
</svg>